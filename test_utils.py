import pandas as pd
from utils.data_processing import get_windows_data

# sample data
data = """
timestamp,icao24,callsign,longitude,latitude,altitude,geoaltitude,groundspeed,heading_unwrapped,vertical_rate,x,y,cumdist,compute_gs
2020-01-01 10:00:01+00:00,4008e6,BAW88MC,-11.5208740234375,39.19248962402344,36975.0,38150.0,432.4739030638047,220.43,0.0,-174684.55655221015,223477.55242333264,0.0,0.0
2020-01-01 10:00:02+00:00,4008e6,BAW88MC,-11.525613536005439,39.19248962402344,36975.0,38150.0,432.4739030638047,220.43,0.0,-175092.0554020406,223486.31398685926,0.22108648672806339,795.9113522210282
2020-01-01 10:00:03+00:00,4008e6,BAW88MC,-11.527046535326061,39.19248962402344,36975.0,38150.0,432.0,220.43,0.0,-175215.26325448265,223488.9670791858,0.2879323449827074,240.64508971671847
2020-01-01 10:00:04+00:00,4008e6,BAW88MC,-11.528539242951751,39.19248962402344,36975.0,38150.0,432.4739030638047,220.43,0.0,-175343.60472469786,223491.73270154392,0.3575634473332053,250.67196846179212
2020-01-01 10:00:05+00:00,4008e6,BAW88MC,-11.52996826171875,39.19248962402344,36975.0,38150.0,432.4739030638047,220.43,0.0,-175466.47025128585,223494.38222127504,0.4242236226503462,239.97663114170714
2020-01-01 10:00:06+00:00,4008e6,BAW88MC,-11.531464949898071,39.19248962402344,36975.0,38150.0,432.4739030638047,220.43,0.0,-175595.1538796587,223497.15919553683,0.49404040793867804,251.3404270379948
2020-01-01 10:00:07+00:00,4008e6,BAW88MC,-11.5328369140625,39.19248962402344,36975.0,38150.0,432.4739030638047,220.43,0.0,-175713.11383373092,223499.70654369795,0.5580391277888268,230.39539146053565
2020-01-01 10:00:08+00:00,4008e6,BAW88MC,-11.534510073454499,39.19248962402344,36975.0,38150.0,432.4739030638047,220.43,0.0,-175856.97016870845,223502.81544114675,0.6360878567344789,280.9754242043476
2020-01-01 10:00:09+00:00,4008e6,BAW88MC,-11.53521728515625,39.191630735235705,36975.0,38150.0,432.4739030638047,220.43,0.0,-175919.82780761807,223409.2323466383,0.6972370405535825,220.13706174877262
2020-01-01 10:00:10+00:00,4008e6,BAW88MC,-11.53755519701087,39.18901062011719,36975.0,38150.0,432.4739030638047,220.43,0.0,-176127.10919348,223124.08836699498,0.8884551059484262,688.3850354214379
2020-01-01 10:00:11+00:00,4008e6,BAW88MC,-11.53904790463656,39.18736267089844,36975.0,38150.0,432.4739030638047,220.40800000000002,0.0,-176259.40172080867,222944.7884930127,1.0093195062943772,435.1118412454232
2020-01-01 10:00:12+00:00,4008e6,BAW88MC,-11.540122654127062,39.18603515625,36975.0,38150.0,432.4739030638047,220.386,0.0,-176354.9935868555,222800.11613893637,1.1033764133193193,338.60486528979226
2020-01-01 10:00:13+00:00,4008e6,BAW88MC,-11.54155565344769,39.1842041015625,36975.0,38150.0,432.4739030638047,220.364,0.0,-176482.60085241322,222600.47796720735,1.2318969921630918,462.6740838375807
2020-01-01 10:00:14+00:00,4008e6,BAW88MC,-11.54304836107337,39.18287658691406,36975.0,38150.0,432.4739030638047,220.34199999999998,0.0,-176614.14069081246,222456.58877655136,1.3376449618181696,380.69269075828043
2020-01-01 10:00:15+00:00,4008e6,BAW88MC,-11.54437255859375,39.18148234739142,36975.0,38150.0,432.4739030638047,220.32,0.0,-176731.35484464339,222305.01474961135,1.4415785626025668,374.16096282383
2020-01-01 10:00:16+00:00,4008e6,BAW88MC,-11.54639202615488,39.17948913574219,36975.0,38150.0,432.4739030638047,220.298,0.0,-176909.8008054038,222088.5633295286,1.5937434423585983,547.7935671217142
2020-01-01 10:00:17+00:00,4008e6,BAW88MC,-11.547586192255439,39.17788696289062,36975.0,38150.0,432.4739030638047,220.27599999999998,0.0,-177016.3433190199,221913.77656907967,1.7047777742792551,399.72359491436407
2020-01-01 10:00:18+00:00,4008e6,BAW88MC,-11.54888916015625,39.17636160123146,36975.0,38150.0,432.4739030638047,220.254,0.0,-177132.06217765211,221747.681804224,1.8145820544527023,395.29540862440996
2020-01-01 10:00:19+00:00,4008e6,BAW88MC,-11.550537109375,39.17445295948093,36975.0,38150.0,432.4739030638047,220.254,0.0,-177278.376471283,221539.8876765596,1.9524341806832322,496.2676544299074
2020-01-01 10:00:20+00:00,4008e6,BAW88MC,-11.5517578125,39.172777078919495,36975.0,38150.0,433.29513683254277,220.254,0.0,-177387.39342749584,221357.01241412194,2.0679193542377092,415.7466247961161
2020-01-01 10:00:21+00:00,4008e6,BAW88MC,-11.553198772927999,39.17152404785156,36975.0,38150.0,432.0,220.254,0.0,-177514.338711375,221221.27148293273,2.1687307458796083,362.9210099108375
2020-01-01 10:00:22+00:00,4008e6,BAW88MC,-11.55475118885869,39.16987609863281,36975.0,38150.0,433.29513683254277,220.254,0.0,-177651.82652136867,221042.1086856046,2.291231550979494,441.00289835958785
2020-01-01 10:00:23+00:00,4008e6,BAW88MC,-11.55645751953125,39.1678425417108,36975.0,38150.0,433.29513683254277,220.254,0.0,-177803.4889567996,220820.63319634198,2.436834707670145,524.1713640863435
2020-01-01 10:00:24+00:00,4008e6,BAW88MC,-11.557861328125,39.16621321338718,36975.0,38150.0,433.29513683254277,220.254,0.0,-177928.16303204946,220643.25363947288,2.554439990616113,423.3790186054847
2020-01-01 10:00:25+00:00,4008e6,BAW88MC,-11.559326171875,39.16444422835011,36975.0,38150.0,433.29513683254277,220.254,0.0,-178058.42974600187,220450.56093615916,2.680606377671652,454.1989933999419
2020-01-01 10:00:26+00:00,4008e6,BAW88MC,-11.56078172766644,39.16282653808594,36975.0,38150.0,433.29513683254277,220.254,0.0,-178187.537534653,220274.5690508065,2.7990034079219934,426.22930890122876
2020-01-01 10:00:27+00:00,4008e6,BAW88MC,-11.56243896484375,39.16113901946504,36975.0,38150.0,433.29513683254277,220.254,0.0,-178334.16744297722,220091.24453923438,2.9263405468148673,458.41370001434575
2020-01-01 10:00:28+00:00,4008e6,BAW88MC,-11.563720703125,39.159742452330505,36975.0,38150.0,433.29513683254277,220.254,0.0,-178447.79966736434,219939.36054880143,3.0292329265011686,370.4125668706865
2020-01-01 10:00:29+00:00,4008e6,BAW88MC,-11.56512451171875,39.15806657176907,36975.0,38150.0,432.0,220.254,0.0,-178572.61348045408,219756.84860133854,3.1491698704804483,431.77299832540604
2020-01-01 10:00:30+00:00,4008e6,BAW88MC,-11.566650390625,39.156297586731995,36975.0,38150.0,433.29513683254277,220.254,0.0,-178708.159171438,219564.28269675985,3.276906414763508,459.851559419015
2020-01-01 10:00:31+00:00,4008e6,BAW88MC,-11.56817626953125,39.154528601694906,36975.0,38150.0,433.29513683254277,220.254,0.0,-178843.71111496087,219371.71930716935,3.4046439264068806,459.8550419161409
2020-01-01 10:00:32+00:00,4008e6,BAW88MC,-11.56976318359375,39.15289927337129,36975.0,38150.0,433.29513683254277,220.254,0.0,-178984.18048426346,219194.70388179302,3.527222686511576,441.2835363769026
2020-01-01 10:00:33+00:00,4008e6,BAW88MC,-11.57135009765625,39.1512451171875,36975.0,38150.0,433.29513683254277,220.254,0.0,-179124.71621212628,219014.94799611557,3.6509916159679476,445.5681460429378
2020-01-01 10:00:34+00:00,4008e6,BAW88MC,-11.57244873046875,39.14987337791313,36975.0,38150.0,433.29513683254277,220.254,0.0,-179222.5649443804,218865.47238363503,3.747900067847408,348.8704267660588
2020-01-01 10:00:35+00:00,4008e6,BAW88MC,-11.5738525390625,39.14815094511388,36975.0,38150.0,433.29513683254277,220.254,0.0,-179347.5250827759,218677.83037565064,3.870188736352057,440.23920661673543
2020-01-01 10:00:36+00:00,4008e6,BAW88MC,-11.57550048828125,39.146288855601156,36975.0,38150.0,433.29513683254277,220.254,0.0,-179493.83496971257,218475.22382810016,4.005750611049326,488.0227489101676
2020-01-01 10:00:37+00:00,4008e6,BAW88MC,-11.577320928158938,39.14442443847656,36975.0,38150.0,432.0,220.254,0.0,-179654.99772255178,218272.69057772917,4.146150473085653,505.43950333077754
2020-01-01 10:00:38+00:00,4008e6,BAW88MC,-11.57869421917457,39.14291381835938,36975.0,38150.0,433.29513683254277,220.254,0.0,-179776.8339433729,218108.39989305285,4.257099440903569,399.4162841444974
2020-01-01 10:00:39+00:00,4008e6,BAW88MC,-11.57947042713994,39.14190673828125,36975.0,38150.0,433.29513683254277,220.254,0.0,-179846.07413473257,217998.6090281415,4.327508239904194,253.47167640225098
2020-01-01 10:00:40+00:00,4008e6,BAW88MC,-11.580724301545501,39.14044189453125,36975.0,38150.0,433.29513683254277,220.254,0.0,-179957.5318463523,217839.15189694916,4.4330393720374275,379.91207567963767
2020-01-01 10:00:41+00:00,4008e6,BAW88MC,-11.58306884765625,39.138002557269594,36975.0,38150.0,433.29513683254277,220.254,0.0,-180165.21863772662,217574.10750832426,4.615692391830244,657.5508712541395
2020-01-01 10:00:42+00:00,4008e6,BAW88MC,-11.58442621645719,39.13627624511719,36975.0,38150.0,433.29513683254277,220.254,0.0,-180286.23291431397,217385.96454230923,4.737037018115823,436.8406546280828
2020-01-01 10:00:43+00:00,4008e6,BAW88MC,-11.58532184103262,39.1351318359375,36975.0,38150.0,433.29513683254277,220.254,0.0,-180366.09710706337,217261.23366376327,4.817376891316419,289.2235435221463
2020-01-01 10:00:44+00:00,4008e6,BAW88MC,-11.587646484375,39.13283525887182,36975.0,38150.0,433.29513683254277,220.254,0.0,-180571.74884284078,217011.93533116434,4.992681650939606,631.0971346434766
2020-01-01 10:00:45+00:00,4008e6,BAW88MC,-11.58856201171875,39.13181110963983,36975.0,38150.0,434.0,220.254,0.0,-180653.038629844,216900.53223754157,5.067488745720498,269.3055412112086
2020-01-01 10:00:46+00:00,4008e6,BAW88MC,-11.58979996390963,39.13037109375,36975.0,38150.0,433.29513683254277,220.254,0.0,-180763.09540105454,216743.79998767408,5.171373877250887,373.9864735093995
2020-01-01 10:00:47+00:00,4008e6,BAW88MC,-11.59141208814538,39.1285400390625,36975.0,38150.0,433.29513683254277,220.254,0.0,-180906.314575884,216544.5818892825,5.30446576043689,479.1307794696114
2020-01-01 10:00:48+00:00,4008e6,BAW88MC,-11.59307861328125,39.12669036347987,36975.0,38150.0,433.29513683254277,220.254,0.0,-181054.26778141607,216343.41341479073,5.4399237673168335,487.64882476779917
2020-01-01 10:00:49+00:00,4008e6,BAW88MC,-11.594636336616821,39.12492370605469,36975.0,38150.0,433.29513683254277,220.254,0.0,-181192.66087525073,216151.2115375212,5.56839758623282,462.5057480975487
2020-01-01 10:00:50+00:00,4008e6,BAW88MC,-11.594636336616821,39.12492370605469,36975.0,38150.0,433.29513683254277,220.22885714285712,0.0,-181192.66087525073,216151.2115375212,5.56839758623282,0.0
"""

from io import StringIO
df = pd.read_csv(StringIO(data))
FEATURES = ["altitude", "groundspeed", "vertical_rate", "x", "y"]

X, y = get_windows_data(df[FEATURES], [0] * df.shape[0], window_size=5, tsfresh=False)

print("X Data:")
print(X)
print("\nY Data:")
print(y)


